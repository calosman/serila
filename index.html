<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Serila Conciergerie - Filtres et Fade Améliorés</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
  <style>
    /* Styles généraux inchangés... */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    nav {
      position: fixed; top: 0; width: 100%;
      background-color: rgba(0, 0, 0, 0.85); z-index: 20;
      display: flex; justify-content: center; padding: 15px 0;
    }
    nav ul { list-style: none; display: flex; gap: 40px; }
    nav ul li a { color: white; text-decoration: none; font-size: 1.1rem; }
    body {
      font-family: 'Georgia', serif; background-color: #111;
      color: #fff; line-height: 1.6;
    }

    /* ✨ MODIFICATION CSS 1 : On applique un filtre sombre à TOUTES les vidéos */
    video {
      filter: brightness(0.65); /* Assombrit la vidéo à 65%. Ajustez si besoin (ex: 0.7) */
    }

    .fullscreen-video {
      position: relative; height: 100vh; width: 100%; overflow: hidden;
    }
    .fullscreen-video video {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      object-fit: cover; z-index: 0;
    }
    .fullscreen-overlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      z-index: 1;
    }
    .fullscreen-text {
      position: absolute;
      top: 50%;
      right: 10%;
      transform: translateY(-50%);
      z-index: 2;
      text-align: right;
      max-width: 450px;
      transition: opacity 0.2s ease-out;
    }
    .fullscreen-text h1 { font-size: 3rem; }

    .services-container {
      position: relative;
      display: flex;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      z-index: 3;
      background-color: #111;
    }
    /* Les images ne sont plus utilisées comme fond, on peut retirer le filtre d'ici */
    .services-container img {
      width: 50%;
      height: 100%;
      object-fit: cover;
    }

    .services-content {
      position: absolute;
      width: 100%;
      text-align: center;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2;
      padding: 20px;
      background: none;
      font-size: inherit;
      /* ✨ MODIFICATION CSS 2 : On retire la transition car elle sera gérée par JS */
      /* Le fade sera si progressif qu'une transition n'est plus nécessaire */
      opacity: 0; /* On le cache par défaut, JS le révélera */
    }

    .services-content h1 {
      font-size: 3rem;
      font-family: 'Georgia', serif;
      font-weight: normal;
      line-height: 1.4;
      color: #fff;
    }

    /* Styles des sections suivantes inchangés... */
    .video-section-dessous {
      width: 100%; overflow: hidden; position: relative;
      z-index: 3;
      background-color: #111;
    }
    .video-section-dessous video { width: 100%; height: auto; display: block; }
    .contact { text-align: center; background: #111; padding: 60px 20px; position: relative; z-index: 3;}
    footer { text-align: center; padding: 30px; background: #000; position: relative; z-index: 3;}
    .scroll-video-wrapper { height: 250vh; position: relative; background-color: #111; }
    .sticky-video-container { position: sticky; top: 0; height: 100vh; width: 100%; overflow: hidden; z-index: 1; will-change: transform; }
    #scroll-video { width: 100%; height: 100%; object-fit: cover; }
    .about-text-overlay { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 2; max-width: 650px; padding: 30px; text-align: center; background: rgba(0, 0, 0, 0.35); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); border-radius: 15px; color: #fff; }
    .about-text-overlay h2 { font-size: 2.5rem; margin-bottom: 15px; font-family: 'Playfair Display', serif; }
    .about-text-overlay p { font-size: 1.1rem; line-height: 1.7; }
  </style>
</head>
<body>

  <nav>
    <ul>
      <li><a href="#accueil">Accueil</a></li><li><a href="#services">Nos services</a></li><li><a href="#apropos">À propos</a></li><li><a href="#contact">Contact</a></li>
    </ul>
  </nav>

  <section id="accueil" class="fullscreen-video">
    <video autoplay muted loop playsinline src="https://res.cloudinary.com/daefs8yza/video/upload/v1752690635/Drone_Site_Serila_zucdyd.mov"></video>
    <div class="fullscreen-overlay">
      <div class="fullscreen-text" id="hero-text">
        <h1>L’art de célébrer<br>dans une paix absolue.</h1>
      </div>
    </div>
  </section>

  <section id="services" class="services-container">
    <img src="gallery1.png" alt="fond 1">
    <img src="gallery2.png" alt="fond 2">
    <div class="services-content" id="services-text">
      <h1>De l’organisation de mariage<br>à la conciergerie haut de gamme</h1>
    </div>
  </section>

  <div id="apropos" class="scroll-video-wrapper">
    <div class="sticky-video-container">
      <video id="scroll-video" preload="metadata" playsinline>
        <source src="video1.mp4" type="video/mp4">
      </video>
      <div class="about-text-overlay">
        <h2>À propos</h2>
        <p>Serila Conciergerie est née d'une passion pour l'élégance et la sérénité. Nous orchestrons vos événements avec rigueur, sensibilité et un goût prononcé pour le détail. Faites l'expérience d'une organisation fluide et haut de gamme, où vous n'avez qu'à profiter.</p>
      </div>
    </div>
  </div>

  <section class="video-section-dessous">
    <video autoplay muted loop playsinline src="video2.mp4"></video>
  </section>

  <section id="contact" class="contact"></section>
  <footer></footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
  <script>
    AOS.init({ once: true, duration: 800 });

    // --- GESTION DES ANIMATIONS AU SCROLL ---

    // 1. On sélectionne tous les éléments dont on a besoin
    const heroText = document.getElementById('hero-text');
    const servicesText = document.getElementById('services-text');
    const servicesSection = document.getElementById('services');
    const scrollVideo = document.getElementById('scroll-video');
    const scrollVideoWrapper = document.querySelector('.scroll-video-wrapper');

    // ✨ MODIFICATION JAVASCRIPT : On a maintenant une logique de fade plus longue et progressive
    function handleServicesFade() {
      if (!servicesSection || !servicesText) return;

      const rect = servicesSection.getBoundingClientRect();
      const screenCenter = window.innerHeight / 2;
      const sectionCenter = rect.top + rect.height / 2;
      const distanceFromCenter = Math.abs(sectionCenter - screenCenter);

      // La zone sur laquelle le fondu se produit.
      // Une valeur plus grande = un fondu plus long et plus doux.
      const fadeZone = window.innerHeight * 0.7; // On fait le fondu sur 70% de la hauteur de l'écran

      const opacity = Math.max(0, 1 - (distanceFromCenter / fadeZone));
      servicesText.style.opacity = opacity.toFixed(2);
    }

    function handleHeroFade() {
      if (!heroText) return;
      const fadeDistance = 300; 
      const scrollY = window.scrollY;
      const opacity = Math.max(0, 1 - (scrollY / fadeDistance));
      heroText.style.opacity = opacity;
    }

    function handleVideoScrub() {
      if (!scrollVideo || !scrollVideo.duration || !scrollVideoWrapper) return;
      const rect = scrollVideoWrapper.getBoundingClientRect();
      if (rect.top <= 0 && rect.bottom >= 0) {
        const scrollPercent = (-rect.top) / (scrollVideoWrapper.scrollHeight - window.innerHeight);
        const clampedPercent = Math.min(1, Math.max(0, scrollPercent));
        scrollVideo.currentTime = scrollVideo.duration * clampedPercent;
      }
    }

    // 2. On crée un seul écouteur de scroll optimisé qui gère tout
    let ticking = false;
    document.addEventListener('scroll', () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          handleHeroFade();
          handleServicesFade(); // On appelle la nouvelle fonction de fade ici
          handleVideoScrub();
          ticking = false;
        });
        ticking = true;
      }
    });

    // 3. Script pour la vidéo contrôlée au scroll (juste l'initialisation)
    if(scrollVideo) {
      scrollVideo.addEventListener('loadedmetadata', () => {
        scrollVideo.pause();
      });
    }
  </script>
</body>
</html>
